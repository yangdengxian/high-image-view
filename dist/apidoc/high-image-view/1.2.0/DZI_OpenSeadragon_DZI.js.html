<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: DZI/OpenSeadragon_DZI.js</title>

    <script src="scripts/prettify.js"> </script>
    <script src="scripts/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/tomorrow.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: DZI/OpenSeadragon_DZI.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import OpenSeadragonImageViewer from '../OpenSeadragonImageViewer';
import { extend, ajaxGetReqeust } from '../../util/Util';
/**
 * @classdesc OpenSeadragon_DZI（Deep Zoom Image）图片浏览控件
 * @author ydx
 * @date 2019-05-29
 * @moudle OpenSeadragon/DZI/OpenSeadragon_DZI
 */
class OpenSeadragon_DZI {
    /**
     * @param {*} param 
     * @param {string} param.id image view container id,  required
     * @param {string} param.loadingId image loading container id eg: &lt;div id="load">&lt;/div>, required
     * @param {string} param.prefixUrl vierControl toolbar imagesUrl
     * @param {string} param.imagePath targetImageUrl, required
     * @param {string} param.tileServerUrl request tileServerUrl, required
     * @param {string} param.tileSources request tileSources, required
     */
    constructor(param) {
        param = extend(param || {}, {
            tileSources: "/imageDZI/flower.dzi",
            prefixUrl: 'images/',
        });
        this.createTileSources(param);
    }

    /**
     * @description create tiles images
     * @param {*} param 
     */
    createTileSources(param) {
        ajaxGetReqeust(param.tileServerUrl, {
            dataType: 'json',
            data: {
                imagePath: param.imagePath,
            },
            beforeSend: (e) => {
                if (e.readyState !== 4) {
                    //openSeadragon container
                    if (document.getElementById(param.id)) {
                        document.getElementById(param.id).style.visibility = "hidden";
                    }
                }
            },
            complete: (XMLHttpRequest, status) => {
                if (status == 'error' || status == 'timeout') { //超时,status还有success,error等值的情况
                    console.error(url, param, status);
                    XMLHttpRequest.abort();
                }
                setTimeout(function() {
                    if (document.getElementById(param.id) &amp;&amp; document.getElementById(param.loadingId)) {
                        document.getElementById(param.loadingId).style.visibility = "hidden";
                        document.getElementById(param.id).style.visibility = "visible";
                    }
                }, 1000);
            }
        }).then(
            result => {
                if (result &amp;&amp; result.tilesPath) {
                    new OpenSeadragonImageViewer({
                        id: param.id,
                        prefixUrl: param.prefixUrl,
                        tileSources: param.tileSources + result.tilesPath, //必填
                    });
                }
            },
            error => {
                console.error(error);
            }
        );
    }
};

export default OpenSeadragon_DZI;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-OpenSeadragon_OpenSeadragonImageViewer.html">OpenSeadragon/OpenSeadragonImageViewer</a></li></ul><h3>Classes</h3><ul><li><a href="module-OpenSeadragon_OpenSeadragonImageViewer-OpenSeadragonImageViewer.html">OpenSeadragonImageViewer</a></li><li><a href="OpenSeadragon_CTS.html">OpenSeadragon_CTS</a></li><li><a href="OpenSeadragon_DZI.html">OpenSeadragon_DZI</a></li><li><a href="OpenSeadragon_ITS.html">OpenSeadragon_ITS</a></li><li><a href="OpenSeadragon_OSM.html">OpenSeadragon_OSM</a></li><li><a href="OpenSeadragon_TMS.html">OpenSeadragon_TMS</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Wed Jun 05 2019 13:42:49 GMT+0800 (GMT+08:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
